				;file E:\Doing\0 音頻口通信\ASSP MCU\hijiack\source code\main.asm
				;1	;___________________________________________________________________
				;2	;___________________________________________________________________
				;3	;Copyright :    2015 by HOLTEK SEMICONDUCTOR INC
				;4	;File Name :    main.asm
				;5	;Targer :       hijack Board
				;6	;MCU :          HT68F002
				;7	;Version :      V00
				;8	;Author :       ChenTing
				;9	;Date :         2015/04/10
				;10	;Description :  hijack 音頻通信測試
				;11	;History : 
				;12	;___________________________________________________________________
				;13	;___________________________________________________________________
				;14	
				;15	include config.inc
				;16	include target.inc
				;17	include hijack.inc
				;18	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;19	;@------------------------Library API------------------------------@
				;20	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;21	EXTERN  _CLEAR_RAM				:NEAR
				;22	EXTERN  _INIT_PORT				:NEAR 
				;23	EXTERN  _INIT_WDT				:NEAR
				;24	EXTERN  _INIT_SysFrequency		:NEAR
				;25	EXTERN  _INIT_LVD				:NEAR
				;26	EXTERN  _IIC_INT_ISR			:NEAR
				;27	EXTERN  _IIC_init				:NEAR
				;28	
				;29	EXTERN  _hijack_Receive			:NEAR
				;30	EXTERN  _hijack_Send			:NEAR
				;31	EXTERN  _hijack_init			:NEAR
				;32	
				;33	EXTERN	hijack_Receive_DataH	:BYTE
				;34	EXTERN	hijack_Receive_DataL	:BYTE
				;35	EXTERN	hijack_Send_Data_High	:BYTE
				;36	EXTERN	hijack_Send_Data_Low	:BYTE
				;37	EXTERN	IIC_Receive_Data 		:BYTE
				;38	EXTERN	IIC_Send_Data 			:BYTE
				;39	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;40	;@------------------------Library API------------------------------@
				;41	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;42	public	F_EMI
				;43	public	R_ATEMP
				;44	public  R_STATUS
				;45	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;46	;@-----------------------------DATA--------------------------------@
				;47	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ 
				;48	ds	.section	'data'    
				;49	F_EMI					DBIT
				;50	R_ATEMP					DB	?
				;51	R_STATUS				DB	?
				;52	
				;53	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;54	;@-----------------------------CODE--------------------------------@
				;55	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;56	cs	.section	at  000h	'code'
				;57	        ORG     START_VECTOR
				;58	        SNZ     TO
				CS:
				include HT68F002.inc
0000	3A8A	snz     TO
				;59	        JMP     POWER_ON
0001	2819	jmp     POWER_ON
				;60	        JMP     MAIN
0002	2828	jmp     MAIN
0003	0000	nop
				;61	;ISR VECTOR Defination
				;62	        ORG     INT0_VECTOR
				;63	        JMP		_IIC_INT_ISR		;IIC從機子程序
0004	284E	jmp     _IIC_INT_ISR
				;64	        RETI
0005	0004	reti
0006	0000	nop
0007	0000	nop
				;65	;
				;66	        ORG		Timebase0_VECTOR 
				;67	        RETI
0008	0004	reti
0009	0000	nop
000A	0000	nop
000B	0000	nop
				;68	;
				;69			ORG		Timebase1_VECTOR
				;70			RETI
000C	0004	reti
000D	0000	nop
000E	0000	nop
000F	0000	nop
				;71	;
				;72			ORG		M_FUNCTION0_VECTOR
				;73			JMP		_hijack_Receive
0010	28E0	jmp     _hijack_Receive
				;74			RETI
0011	0004	reti
0012	0000	nop
0013	0000	nop
				;75	;
				;76			ORG		EEPROM_VECTOR
				;77			RETI
0014	0004	reti
0015	0000	nop
0016	0000	nop
0017	0000	nop
				;78	;
				;79			ORG		ADC_VECTOR
				;80			RETI
0018	0004	reti
				;81	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;82						;---------Power ON-------------;
				;83	POWER_ON:
				;84			CALL	_CLEAR_RAM
				POWER_ON:
0019	202F	call    _CLEAR_RAM
				;85			CALL	_INIT_PORT
001A	2037	call    _INIT_PORT
				;86			CALL	_INIT_WDT
001B	2045	call    _INIT_WDT
				;87			CALL	_INIT_SysFrequency
001C	2048	call    _INIT_SysFrequency
				;88			CALL	_INIT_LVD
001D	204B	call    _INIT_LVD
				;89			CALL	_IIC_init
001E	20BB	call    _IIC_init
				;90			CALL	_hijack_init
001F	21EE	call    _hijack_init
				;91			MOV		A,000H
0020	0F00	mov     a, 0H
				;92			MOV		IIC_Send_Data,A
0021	00C5	mov     IIC_SEND_DATA, a
				;93			CLR		PAC3
0022	3595	clr     PAC3
				;94			SET		PA3
0023	3194	set     PA3
				;95			MOV		A,0A5H
0024	0FA5	mov     a, A5H
				;96			MOV		hijack_Send_Data_High,A
0025	00CC	mov     HIJACK_SEND_DATA_HIGH, a
				;97			MOV		A,05AH
0026	0F5A	mov     a, 5AH
				;98			MOV		hijack_Send_Data_Low,A
0027	00CD	mov     HIJACK_SEND_DATA_LOW, a
				;99			
				;100	MAIN:
				;101	
				;102			CLR		WDT
				MAIN:
0028	0001	clr     wdt
				;103			CLR		WDT1
0029	0001	clr     wdt
				;104			CLR		WDT2
002A	0005	clr     wdt2
				;105			NOP
002B	0000	nop
				;106			CLR		EMI
002C	340E	clr     EMI
				;107			CALL	_hijack_Send
002D	20C5	call    _hijack_Send
				;108		
				;109			JMP		MAIN
002E	2828	jmp     MAIN
				;110	
				;111	
				;file E:\Doing\0 音頻口通信\ASSP MCU\hijiack\source code\sysyinit.asm
				;1	;___________________________________________________________________
				;2	;___________________________________________________________________
				;3	;Copyright :    2015 by HOLTEK SEMICONDUCTOR INC
				;4	;File Name :    sysinit.asm
				;5	;Targer :       hijack TEST Board
				;6	;MCU :          HT68F002
				;7	;Version :      V00
				;8	;Author :       ChenTing
				;9	;Date :         2015/04/10
				;10	;Description :  音頻通信程序測試
				;11	;				系統初始化程序
				;12	;History : 
				;13	;___________________________________________________________________
				;14	;___________________________________________________________________
				;15	include config.inc
				;16	include target.inc
				;17	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;18	;@---------------------Library API------------------------------@
				;19	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ 
				;20	Public 	_CLEAR_RAM
				;21	Public 	_INIT_PORT
				;22	Public	_INIT_WDT
				;23	public  _INIT_SysFrequency
				;24	public  _INIT_LVD
				;25	
				;26	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;27	
				;28							;-----------Clear RAM----------;
				;29	;@SUBROUTINE
				;30	;HT66F4540 , bank0:40h-FFh  )
				;31	_CLEAR_RAM PROC
				;32	        mov     A,040H          
				_CLEAR_RAM:
002F	0F40	mov     a, 40H
				;33	        mov     MP0,A           
0030	0081	mov     MP0, a
				;34	        mov     A,64d          
0031	0F40	mov     a, 40H
				;35	CLEAR_RAM_LOOP:                    
				;36	        clr     IAR0            
				CLEAR_RAM_LOOP:
0032	1F00	clr     [00H]
				;37	        inc     MP0             
0033	1481	inc     MP0
				;38	        SDZ     ACC             
0034	1785	sdz     ACC
				;39	        JMP     CLEAR_RAM_LOOP     
0035	2832	jmp     CLEAR_RAM_LOOP
				;40	        RET
0036	0003	ret
				;41	_CLEAR_RAM ENDP
				;42	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;43							;----------Initial Port----------;
				;44	;SUBROUTINE
				;45	_INIT_PORT PROC
				;46	        MOV     A,00H
				_INIT_PORT:
0037	0F00	mov     a, 0H
				;47	        MOV     PA,A        
0038	0094	mov     PA, a
				;48	        MOV     A,00H
0039	0F00	mov     a, 0H
				;49	        MOV     PAC,A      
003A	0095	mov     PAC, a
				;50	        MOV		A,00H
003B	0F00	mov     a, 0H
				;51	        MOV		PAPU,A       
003C	0096	mov     PAPU, a
				;52	        MOV		A,00H
003D	0F00	mov     a, 0H
				;53	        MOV		PAWU,A
003E	0097	mov     PAWU, a
				;54	
				;55			MOV		A,00H
003F	0F00	mov     a, 0H
				;56			MOV		PASR,A
0040	00A6	mov     PASR, a
				;57	
				;58			SET		PAC6		
0041	3315	set     PAC6
				;59			SET		PAC1
0042	3095	set     PAC1
				;60			SET		PAWU1	        	
0043	3097	set     PAWU1
				;61	        RET
0044	0003	ret
				;62	_INIT_PORT ENDP
				;63	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;64							;----------Initial WDTC----------;
				;65	;SUBROUTINE
				;66	_INIT_WDT PROC
				;67		    MOV		A,WDT_Function_Default
				_INIT_WDT:
0045	0F53	mov     a, 53H
				;68		    MOV		WDTC,A    	
0046	0099	mov     WDTC, a
				;69	        RET
0047	0003	ret
				;70	_INIT_WDT ENDP
				;71	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@       
				;72							;----------Initial SysFrequency----------;
				;73	;SUBROUTINE
				;74	_INIT_SysFrequency PROC
				;75		    MOV		A,SYSFrequency_Default
				_INIT_SysFrequency:
0048	0FE0	mov     a, E0H
				;76		    MOV		SMOD,A    	
0049	008B	mov     SMOD, a
				;77	        RET
004A	0003	ret
				;78	_INIT_SysFrequency ENDP
				;79	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  
				;80							;----------Initial LVD----------;
				;81	;SUBROUTINE
				;82	_INIT_LVD PROC
				;83		    MOV		A,LVD_Voltage_Default
				_INIT_LVD:
004B	0F11	mov     a, 11H
				;84		    MOV		LVDC,A    	
004C	008C	mov     LVDC, a
				;85	        RET
004D	0003	ret
				;86	_INIT_LVD ENDP
				;87	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  
				;88							;----------Initial EMI----------;
				;89	;SUBROUTINE
				;90	;_INIT_LVD PROC
				;91	;	    MOV		A,LVD_Voltage_Default
				;92	;	    MOV		LVDC,A    	
				;93	;        RET
				;94	;_INIT_LVD ENDP
				;95	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ 
				;file E:\Doing\0 音頻口通信\ASSP MCU\hijiack\source code\IIC_Slave.asm
				;1	;___________________________________________________________________
				;2	;___________________________________________________________________
				;3	;Copyright :    2015 by HOLTEK SEMICONDUCTOR INC
				;4	;File Name :    sysinit.asm
				;5	;Targer :       hijack TEST Board
				;6	;MCU :          HT68F002
				;7	;Version :      V00
				;8	;Author :       ChenTing
				;9	;Date :         2015/04/10
				;10	;Description :  音頻通信程序測試
				;11	;				IIC_Slave程序
				;12	;History : 
				;13	;___________________________________________________________________
				;14	;___________________________________________________________________
				;15	include config.inc
				;16	include target.inc
				;17	
				;18	#define IIC_Device_Addr_Default 028H
				;19	#define IIC_Time_Out_Count		200
				;20	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;21	;@---------------------Library API------------------------------@
				;22	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ 
				;23	EXTERN	R_STATUS 			:BYTE
				;24	EXTERN	R_ATEMP 			:BYTE
				;25	
				;26	Public 	_IIC_INT_ISR
				;27	public  IIC_Receive_Data
				;28	public	IIC_Send_Data
				;29	public  _IIC_init
				;30	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;31	;@------------------------------DATA----------------------------@
				;32	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;33	rambank 0  IIC_Slave_datal
				;34	IIC_Slave_datal	.section	'data'   
				;35	
				;36	IIC_Device_Addr			DB	?
				;37	IIC_Receive_Data		DB	?
				;38	IIC_Send_Data			DB	?
				;39	IIC_temp_conunt1		DB	?
				;40	IIC_temp_conunt2		DB	?
				;41	IIC_temp_BYTE			DB	?
				;42	IIC_temp_Flag			DBIT
				;43	
				;44	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;45	;@-------------------------------CODE---------------------------@
				;46	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;47	IIC_Slave_code	.section	'code' 
				;48	
				;49	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;50	 _IIC_INT_ISR PROC
				;51	 		PUSH
				_IIC_INT_ISR:
				IIC_SLAVE_CODE:
004E	00C1	mov     R_ATEMP, a
004F	070A	mov     a, STATUS
0050	00C2	mov     R_STATUS, a
				;52	 		CLR		INTE
0051	348E	clr     INTE
				;53	;判斷是否為有效start信號
				;54			SNZ		IIC_SCL		
0052	3A14	snz     PA4
				;55			JMP		_IIC_RET				;SDA下降沿的時候，SCL為low，不是IIC start信號
0053	286B	jmp     _IIC_RET
				;56	;讀取Device address
				;57			CALL	_IIC_Read_BYTEData		;讀取IIC 主機發送過來的設備地址
0054	2071	call    _IIC_Read_BYTEData
				;58	Device_Addr_Judge:	;判斷地址是否匹配
				;59			MOV		A,IIC_temp_BYTE
				Device_Addr_Judge:
0055	0748	mov     a, IIC_TEMP_BYTE
				;60			MOV		IIC_Device_Addr,A
0056	00C3	mov     IIC_DEVICE_ADDR, a
				;61			MOV		A,0feH					;取出地址數據		
0057	0FFE	mov     a, FEH
				;62			AND		A,IIC_Device_Addr
0058	0643	and     a, IIC_DEVICE_ADDR
				;63			XOR		A,IIC_Device_Addr_Default
0059	0C28	xor     a, 28H
				;64			SNZ		Z
005A	390A	snz     Z
				;65			JMP		_IIC_RET				;地址不匹配，則退出
005B	286B	jmp     _IIC_RET
				;66	;地址匹配，發送ACK給主機
				;67			CALL	IIC_Ack					;收到設備地址，對設備地址ACK應答		
005C	20A9	call    IIC_Ack
				;68	;地址匹配，判斷主機需要讀取數據還是寫入數據
				;69			MOV		A,01H					;取出地址數據		
005D	0F01	mov     a, 1H
				;70			AND		A,IIC_Device_Addr
005E	0643	and     a, IIC_DEVICE_ADDR
				;71			SZ		ACC
005F	1085	sz      ACC
				;72			JMP		IIC_Master_Read			;主機需要讀取數據
0060	2862	jmp     IIC_Master_Read
				;73			JMP		IIC_Master_Write		;主機需要寫入數據
0061	2867	jmp     IIC_Master_Write
				;74	IIC_Master_Read:
				;75			MOV		A,IIC_Send_Data
				IIC_Master_Read:
0062	0745	mov     a, IIC_SEND_DATA
				;76			MOV		IIC_temp_BYTE,A
0063	00C8	mov     IIC_TEMP_BYTE, a
				;77			CALL	_IIC_Write_BYTEData
0064	208D	call    _IIC_Write_BYTEData
				;78	;TEST START
				;79	TEST:;20150423
				;80			INC		IIC_Send_Data
				TEST:
0065	14C5	inc     IIC_SEND_DATA
				;81	;TEST END
				;82	;目前就完成單個字節的讀寫操作
				;83			JMP		_IIC_RET
0066	286B	jmp     _IIC_RET
				;84	IIC_Master_Write:		
				;85			CALL	_IIC_Read_BYTEData
				IIC_Master_Write:
0067	2071	call    _IIC_Read_BYTEData
				;86			MOV		A,IIC_temp_BYTE
0068	0748	mov     a, IIC_TEMP_BYTE
				;87			MOV		IIC_Receive_Data,A
0069	00C4	mov     IIC_RECEIVE_DATA, a
				;88	;;目前就完成單個字節的讀寫操作
				;89			JMP		_IIC_RET
006A	286B	jmp     _IIC_RET
				;90	_IIC_RET:
				;91			SET		INTE
				_IIC_RET:
006B	308E	set     INTE
				;92			CLR		INTF
006C	360E	clr     INTF
				;93	;		SET		EMI
				;94			POP
006D	0742	mov     a, R_STATUS
006E	008A	mov     STATUS, a
006F	0741	mov     a, R_ATEMP
				;95			RETI
0070	0004	reti
				;96	_IIC_INT_ISR ENDP
				;97	
				;98	
				;99	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@	
				;100	_IIC_Read_BYTEData PROC
				;101			SET		IIC_SDA_IO
				_IIC_Read_BYTEData:
0071	3295	set     PAC5
				;102			MOV 	A,9 				;SET 8 BIT COUNTER
0072	0F09	mov     a, 9H
				;103			MOV 	IIC_temp_conunt1,A	
0073	00C6	mov     IIC_TEMP_CONUNT1, a
				;104			CLR		IIC_temp_BYTE
0074	1F48	clr     IIC_TEMP_BYTE
				;105	IIC_Read_LOOP:	
				;106			SDZ 	IIC_temp_conunt1 	;8bit值是否已經讀取完成
				IIC_Read_LOOP:
0075	17C6	sdz     IIC_TEMP_CONUNT1
				;107			JMP		IIC_Read_BYTEData_LOOP
0076	2878	jmp     IIC_Read_BYTEData_LOOP
				;108			RET
0077	0003	ret
				;109	IIC_Read_BYTEData_LOOP:	
				;110			RL	 	IIC_temp_BYTE		;高位在前
				IIC_Read_BYTEData_LOOP:
0078	18C8	rl      IIC_TEMP_BYTE
				;111			MOV		A,IIC_Time_Out_Count;config time out value
0079	0FC8	mov     a, C8H
				;112			MOV		IIC_temp_conunt2,A		
007A	00C7	mov     IIC_TEMP_CONUNT2, a
				;113	$1:						
				;114			SZ		IIC_SCL				;SCL低電平狀態就等待
				L007B:
007B	3E14	sz      PA4
				;115			JMP		$2
007C	2880	jmp     L0080
				;116			SDZ		IIC_temp_conunt2
007D	17C7	sdz     IIC_TEMP_CONUNT2
				;117			JMP		$1
007E	287B	jmp     L007B
				;118			RET
007F	0003	ret
				;119	$2:					
				;120			SNZ		IIC_SDA				;讀取到來的data值
				L0080:
0080	3A94	snz     PA5
				;121			JMP		SDA_LOW0
0081	2885	jmp     SDA_LOW0
				;122			JMP		SDA_HIGH0
0082	2883	jmp     SDA_HIGH0
				;123	SDA_HIGH0:
				;124			SET		IIC_temp_BYTE.0
				SDA_HIGH0:
0083	3048	set     IIC_TEMP_BYTE.0
				;125			JMP		IIC_Read_Next					
0084	2886	jmp     IIC_Read_Next
				;126	SDA_LOW0:
				;127			CLR		IIC_temp_BYTE.0
				SDA_LOW0:
0085	3448	clr     IIC_TEMP_BYTE.0
				;128	IIC_Read_Next:		
				;129			MOV		A,IIC_Time_Out_Count
				IIC_Read_Next:
0086	0FC8	mov     a, C8H
				;130			MOV		IIC_temp_conunt2,A
0087	00C7	mov     IIC_TEMP_CONUNT2, a
				;131	$1:					
				;132			SNZ		IIC_SCL				;SCL高電平就等待
				L0088:
0088	3A14	snz     PA4
				;133			JMP		IIC_Read_LOOP
0089	2875	jmp     IIC_Read_LOOP
				;134			SDZ		IIC_temp_conunt2
008A	17C7	sdz     IIC_TEMP_CONUNT2
				;135			JMP		$1		
008B	2888	jmp     L0088
				;136			RET	
008C	0003	ret
				;137	_IIC_Read_BYTEData ENDP
				;138	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;139	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@	
				;140	_IIC_Write_BYTEData PROC
				;141			CLR		IIC_SDA_IO
				_IIC_Write_BYTEData:
008D	3695	clr     PAC5
				;142			MOV 	A,8 ;SET 8 BIT COUNTER
008E	0F08	mov     a, 8H
				;143			MOV 	IIC_temp_conunt1,A
008F	00C6	mov     IIC_TEMP_CONUNT1, a
				;144			MOV		A,IIC_Time_Out_Count
0090	0FC8	mov     a, C8H
				;145			MOV		IIC_temp_conunt2,A						
0091	00C7	mov     IIC_TEMP_CONUNT2, a
				;146	IIC_Write_BYTEData_LOOP:
				;147			SZ		IIC_SCL				;SCL低電平狀態就等待
				IIC_Write_BYTEData_LOOP:
0092	3E14	sz      PA4
				;148			JMP		$2
0093	2897	jmp     L0097
				;149			SDZ		IIC_temp_conunt2
0094	17C7	sdz     IIC_TEMP_CONUNT2
				;150			JMP		IIC_Write_BYTEData_LOOP
0095	2892	jmp     IIC_Write_BYTEData_LOOP
				;151			RET
0096	0003	ret
				;152	$2:			
				;153	;		MOV		A,80H				;取出地址數據		
				;154	;		AND		A,IIC_temp_BYTE
				;155	;		SZ		ACC
				;156			SZ		IIC_temp_BYTE.7
				L0097:
0097	3FC8	sz      IIC_TEMP_BYTE.7
				;157			JMP		SDA_HIGH1
0098	289A	jmp     SDA_HIGH1
				;158			JMP		SDA_LOW1
0099	289C	jmp     SDA_LOW1
				;159	SDA_HIGH1:
				;160			SET		IIC_SDA
				SDA_HIGH1:
009A	3294	set     PA5
				;161			JMP		Write_Next_Bit
009B	289D	jmp     Write_Next_Bit
				;162	SDA_LOW1:
				;163			CLR		IIC_SDA
				SDA_LOW1:
009C	3694	clr     PA5
				;164	Write_Next_Bit:
				;165			MOV		A,IIC_Time_Out_Count
				Write_Next_Bit:
009D	0FC8	mov     a, C8H
				;166			MOV		IIC_temp_conunt2,A	
009E	00C7	mov     IIC_TEMP_CONUNT2, a
				;167	$2:					
				;168			SNZ		IIC_SCL				;SCL高電平就等待
				L009F:
009F	3A14	snz     PA4
				;169			JMP		$1
00A0	28A4	jmp     L00A4
				;170			SDZ		IIC_temp_conunt2
00A1	17C7	sdz     IIC_TEMP_CONUNT2
				;171			JMP		$2
00A2	289F	jmp     L009F
				;172			RET		
00A3	0003	ret
				;173	$1:		
				;174	;		SET		IIC_SDA_IO				;讓出數據線
				;175			RL		IIC_temp_BYTE
				L00A4:
00A4	18C8	rl      IIC_TEMP_BYTE
				;176			SDZ 	IIC_temp_conunt1 	;8bit值是否已經讀取完成
00A5	17C6	sdz     IIC_TEMP_CONUNT1
				;177			JMP		IIC_Write_BYTEData_LOOP
00A6	2892	jmp     IIC_Write_BYTEData_LOOP
				;178			SET		IIC_SDA_IO				;讓出數據線
00A7	3295	set     PAC5
				;179			RET	
00A8	0003	ret
				;180	_IIC_Write_BYTEData ENDP
				;181	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;182	IIC_Ack PROC
				;183	;應答信號，保證在兩個時鐘條邊沿SDA為低，則主機認為是從機應答
				;184			CLR		IIC_SDA_IO			;config SDA output
				IIC_Ack:
00A9	3695	clr     PAC5
				;185			MOV		A,IIC_Time_Out_Count
00AA	0FC8	mov     a, C8H
				;186			MOV		IIC_temp_conunt2,A
00AB	00C7	mov     IIC_TEMP_CONUNT2, a
				;187	$1:
				;188			SZ		IIC_SCL				;低電平就等待
				L00AC:
00AC	3E14	sz      PA4
				;189			JMP		$2
00AD	28B1	jmp     L00B1
				;190			SDZ		IIC_temp_conunt2
00AE	17C7	sdz     IIC_TEMP_CONUNT2
				;191			JMP		$1
00AF	28AC	jmp     L00AC
				;192			RET
00B0	0003	ret
				;193	$2:			
				;194			CLR		IIC_SDA		;第9個CLK變高的情況下，SDA輸出0
				L00B1:
00B1	3694	clr     PA5
				;195			MOV		A,IIC_Time_Out_Count
00B2	0FC8	mov     a, C8H
				;196			MOV		IIC_temp_conunt2,A
00B3	00C7	mov     IIC_TEMP_CONUNT2, a
				;197	$3:				
				;198			SNZ		IIC_SCL
				L00B4:
00B4	3A14	snz     PA4
				;199			JMP		$4
00B5	28B9	jmp     L00B9
				;200			SDZ		IIC_temp_conunt2
00B6	17C7	sdz     IIC_TEMP_CONUNT2
				;201			JMP		$3
00B7	28B4	jmp     L00B4
				;202			RET
00B8	0003	ret
				;203	$4:				
				;204			SET		IIC_SDA_IO		;第9個CLK變低的情況下，釋放總線
				L00B9:
00B9	3295	set     PAC5
				;205			RET
00BA	0003	ret
				;206	IIC_Ack ENDP
				;207	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;208	_IIC_init PROC
				;209			CLR		IIC_SDA
				_IIC_init:
00BB	3694	clr     PA5
				;210			SET		IIC_SDA_IO		;輸出話IO口設定
00BC	3295	set     PAC5
				;211			SET		IIC_SCL_IO	
00BD	3215	set     PAC4
				;212			CLR		IIC_SCL
00BE	3614	clr     PA4
				;213			
				;214	
				;215			MOV		A,INT0_Default	;config INT觸發中斷
00BF	0F03	mov     a, 3H
				;216			MOV		INTEG,A
00C0	008D	mov     INTEG, a
				;217			CLR		INTF
00C1	360E	clr     INTF
				;218			SET		INTE
00C2	308E	set     INTE
				;219			SET		EMI				;使能INT
00C3	300E	set     EMI
				;220					
				;221			RET
00C4	0003	ret
				;222	_IIC_init ENDP
				;223	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;224	
				;file E:\Doing\0 音頻口通信\ASSP MCU\hijiack\source code\hijack.asm
				;1	;___________________________________________________________________
				;2	;___________________________________________________________________
				;3	;Copyright :    2015 by HOLTEK SEMICONDUCTOR INC
				;4	;File Name :    hijack.asm
				;5	;Targer :       hijack TEST Board
				;6	;MCU :          HT68F002
				;7	;Version :      V00
				;8	;Author :       ChenTing
				;9	;Date :         2015/04/10
				;10	;Description :  音頻通信程序測試
				;11	;				音頻通信主要程序
				;12	;History : 
				;13	;___________________________________________________________________
				;14	;___________________________________________________________________
				;15	include config.inc
				;16	include target.inc
				;17	include hijack.inc
				;18	;#define IIC_Device_Addr_Default 0A0H
				;19	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;20	;@---------------------Library API------------------------------@
				;21	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;22	EXTERN	F_EMI 		:BIT
				;23	EXTERN	R_STATUS 			:BYTE
				;24	EXTERN	R_ATEMP 			:BYTE
				;25	 
				;26	public  _hijack_init
				;27	Public 	_hijack_Receive
				;28	public  _hijack_Send
				;29	
				;30	public	hijack_Send_Data_High
				;31	public	hijack_Send_Data_Low
				;32	public	hijack_Receive_DataH
				;33	public	hijack_Receive_DataL
				;34	
				;35	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;36	;@------------------------------DATA----------------------------@
				;37	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;38	rambank 0  hijack_datal
				;39	hijack_datal	.section	'data'   
				;40	
				;41	hijack_Receive_DataH		DB	?
				;42	hijack_Receive_DataL		DB	?
				;43	hijack_Send_Data_High		DB	?
				;44	hijack_Send_Data_Low		DB	?
				;45	hijack_temp_Byte			DB	?
				;46	hijack_temp_count1			DB	?
				;47	hijack_temp_count2			DB	?
				;48	hijack_CCRP_count			DB	?
				;49	hijack_Rx_step				DB	?
				;50	high_CCRA1_H				DB	?
				;51	high_CCRA1_L				DB	?
				;52	high_CCRA2_H				DB	?
				;53	high_CCRA2_L				DB	?
				;54	hijack_Period_H				DB	?
				;55	hijack_Period_L				DB	?
				;56	TEST_COUNT					DB	?
				;57	TEST_COUNT2					DB	?
				;58	TEST_COUNT3					DB	?
				;59	hijack_Idle_Count			DB	?
				;60	hijack_Rx_Count				DB	?
				;61	hijack_Rx_Parity_Count		DB	?
				;62	
				;63	F_First_CCRA				DBIT
				;64	F_hijack_Rx_Error			DBIT
				;65	F_hijack_Rx_Start			DBIT
				;66	F_CompleteRx1Bit			DBIT
				;67	F_0or1Bit					DBIT
				;68	F_PrepareMode				DBIT
				;69	F_IdleMode					DBIT
				;70	F_ByteMode					DBIT
				;71	F_hijackstartOk				DBIT
				;72	F_Parity_StopMode			DBIT
				;73	F_Parity_Ok					DBIT
				;74	F_Stop_idleMode				DBIT
				;75	F_First_Parity_StopMode		DBIT
				;76	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;77	;@-------------------------------CODE---------------------------@
				;78	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;79	hijack_code	.section	'code' 
				;80	
				;81	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;82	_hijack_Send PROC
				;83			CLR		IIC_SCL_IO;
				_hijack_Send:
				HIJACK_CODE:
00C5	3615	clr     PAC4
				;84			CLR		IIC_SCL		;hijack發送數據的時候拉低SCL，不接收IICdata
00C6	3614	clr     PA4
				;85			SNZ		EMI
00C7	380E	snz     EMI
				;86			JMP		$1
00C8	28CB	jmp     L00CB
				;87			SET		F_EMI
00C9	3040	set     [040H].0
				;88			JMP		$2			
00CA	28CD	jmp     L00CD
				;89	$1:		
				;90			CLR		F_EMI		
				L00CB:
00CB	3440	clr     [040H].0
				;91			JMP		$2
00CC	28CD	jmp     L00CD
				;92	$2:		
				;93			CLR		EMI		;關閉總中斷，防止其他程序打斷
				L00CD:
00CD	340E	clr     EMI
				;94			CLR		hijack_channel_MIC_IO 
00CE	3515	clr     PAC2
				;95			SET		hijack_channel_MIC
00CF	3114	set     PA2
				;96	;建立Bias信號 12bit 0
				;97			CALL	_hijack_Send_Bias		
00D0	2236	call    _hijack_Send_Bias
				;98	;idel信號     3bit  1
				;99			CALL	_hijack_Send_Idle
00D1	2245	call    _hijack_Send_Idle
				;100	;start信號	  1bit  0
				;101			CALL	_hijack_Send_Start				
00D2	2254	call    _hijack_Send_Start
				;102	;發送2Byte data + 奇校驗
				;103	 		CLR		hijack_temp_count2		;作為奇偶校驗位計數
00D3	1F50	clr     HIJACK_TEMP_COUNT2
				;104			MOV		A,hijack_Send_Data_High
00D4	074C	mov     a, HIJACK_SEND_DATA_HIGH
				;105			MOV		hijack_temp_Byte,A
00D5	00CE	mov     HIJACK_TEMP_BYTE, a
				;106			MOV		A,hijack_Send_Data_Low
00D6	074D	mov     a, HIJACK_SEND_DATA_LOW
				;107			MOV		hijack_temp_Byte,A		
00D7	00CE	mov     HIJACK_TEMP_BYTE, a
				;108			CALL	_hijack_Send_Byte
00D8	21FE	call    _hijack_Send_Byte
				;109					
				;110	;stop信號	  1bit 1
				;111			CALL	_hijack_Send_Stop
00D9	225F	call    _hijack_Send_Stop
				;112	;3bit結束信號
				;113			CALL	_hijack_Send_Idle
00DA	2245	call    _hijack_Send_Idle
				;114	
				;115			SNZ		F_EMI
00DB	3840	snz     [040H].0
				;116			JMP		_hijack_Send_RET
00DC	28DE	jmp     _hijack_Send_RET
				;117			SET		EMI			;開啟EMI，
00DD	300E	set     EMI
				;118	_hijack_Send_RET:
				;119			CLR		F_EMI
				_hijack_Send_RET:
00DE	3440	clr     [040H].0
				;120			RET 
00DF	0003	ret
				;121	_hijack_Send ENDP
				;122	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;123	;						_hijack_Receive	Start							@
				;124	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;125	_hijack_Receive PROC
				;126			PUSH
				_hijack_Receive:
00E0	00C1	mov     R_ATEMP, a
00E1	070A	mov     a, STATUS
00E2	00C2	mov     R_STATUS, a
				;127			SNZ		F_hijack_Rx_Start
00E3	395F	snz     HIJACK_RX_PARITY_COUNT[1].2
				;128			JMP		hijack_Normal_Mode
00E4	28F8	jmp     hijack_Normal_Mode
				;129	hijack_Rx_Mode:		
				;130			CALL	_hijack_Rx_1Bit		
				hijack_Rx_Mode:
00E5	2180	call    _hijack_Rx_1Bit
				;131			CALL	_hijack_PrepareMode	
00E6	212E	call    _hijack_PrepareMode
				;132			CALL	_hijack_StartIdleMode		
00E7	2138	call    _hijack_StartIdleMode
				;133			CALL	_hijack_Rx_Byte				
00E8	215C	call    _hijack_Rx_Byte
				;134			CALL	_hijack_Parity_StopMode
00E9	2111	call    _hijack_Parity_StopMode
				;135			CALL	_hijack_ENDIdleMode
00EA	214A	call    _hijack_ENDIdleMode
				;136			
				;137			SNZ		F_hijack_Rx_Error
00EB	38DF	snz     HIJACK_RX_PARITY_COUNT[1].1
				;138			JMP		_hijack_Receive_RET
00EC	290D	jmp     _hijack_Receive_RET
				;139			CLR		F_First_CCRA
00ED	345F	clr     HIJACK_RX_PARITY_COUNT[1].0
				;140			CLR		F_hijack_Rx_Error
00EE	34DF	clr     HIJACK_RX_PARITY_COUNT[1].1
				;141			CLR		TEST_COUNT
00EF	1F59	clr     TEST_COUNT
				;142			CLR		TEST_COUNT2
00F0	1F5A	clr     TEST_COUNT2
				;143			CLR		F_ByteMode
00F1	37DF	clr     HIJACK_RX_PARITY_COUNT[1].7
				;144			CLR		F_CompleteRx1Bit
00F2	35DF	clr     HIJACK_RX_PARITY_COUNT[1].3
				;145			CLR		F_IdleMode
00F3	375F	clr     HIJACK_RX_PARITY_COUNT[1].6
				;146			CLR		F_PrepareMode
00F4	36DF	clr     HIJACK_RX_PARITY_COUNT[1].5
				;147			CLR		F_hijack_Rx_Start
00F5	355F	clr     HIJACK_RX_PARITY_COUNT[1].2
				;148			CLR		F_hijackstartOk
00F6	3460	clr     HIJACK_RX_PARITY_COUNT[2].0
				;149			JMP		_hijack_Receive_RET
00F7	290D	jmp     _hijack_Receive_RET
				;150	
				;151	
				;152			
				;153	hijack_Normal_Mode:	
				;154			SNZ		STMA0F
				hijack_Normal_Mode:
00F8	3A91	snz     STMA0F
				;155			JMP		_hijack_Normal_CCRP_RET	;(not hijack Rx mode)& (not CCRA interrupt) = normal CCRP interrupt
00F9	290A	jmp     _hijack_Normal_CCRP_RET
				;156	;;第一次進入CCRA中斷，初始化相關設置	init hijack Rx Value
				;157			MOV		A,00001000B
00FA	0F08	mov     a, 8H
				;158			XORM	A,PA
00FB	0494	xorm    a, PA
				;159			CLR		STMA0F		
00FC	3691	clr     STMA0F
				;160			SET		F_First_CCRA
00FD	305F	set     HIJACK_RX_PARITY_COUNT[1].0
				;161			CLR		hijack_CCRP_count	
00FE	1F51	clr     HIJACK_CCRP_COUNT
				;162			MOV		A,STM0AH					;Save CCRA value
00FF	072D	mov     a, STM0AH
				;163			MOV		high_CCRA1_H,A	;
0100	00D3	mov     HIGH_CCRA1_H, a
				;164			MOV		A,STM0AL					;
0101	072C	mov     a, STM0AL
				;165			MOV		high_CCRA1_L,A	;
0102	00D4	mov     HIGH_CCRA1_L, a
				;166			INC		TEST_COUNT3
0103	14DB	inc     TEST_COUNT3
				;167			SET		F_hijack_Rx_Start
0104	315F	set     HIJACK_RX_PARITY_COUNT[1].2
				;168			SET		F_PrepareMode
0105	32DF	set     HIJACK_RX_PARITY_COUNT[1].5
				;169			MOV		A,3
0106	0F03	mov     a, 3H
				;170			MOV		hijack_Idle_Count,A
0107	00DC	mov     HIJACK_IDLE_COUNT, a
				;171			CLR		F_hijack_Rx_Error				
0108	34DF	clr     HIJACK_RX_PARITY_COUNT[1].1
				;172			JMP		_hijack_Receive_RET			
0109	290D	jmp     _hijack_Receive_RET
				;173	_hijack_Normal_CCRP_RET:
				;174			SNZ		STMP0F					;CCRP_interrupt也不是 CCRP_interrupt中斷，錯誤
				_hijack_Normal_CCRP_RET:
010A	3A11	snz     STMP0F
				;175			SET		F_hijack_Rx_Error
010B	30DF	set     HIJACK_RX_PARITY_COUNT[1].1
				;176			CLR		STMP0F		
010C	3611	clr     STMP0F
				;177	_hijack_Receive_RET:
				;178			
				;179			POP		
				_hijack_Receive_RET:
010D	0742	mov     a, R_STATUS
010E	008A	mov     STATUS, a
010F	0741	mov     a, R_ATEMP
				;180			RETI 
0110	0004	reti
				;181	_hijack_Receive ENDP
				;182	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;183	;					_hijack_Receive	End		    						@
				;184	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;185	_hijack_Parity_StopMode PROC
				;186			SNZ		F_Parity_StopMode
				_hijack_Parity_StopMode:
0111	38E0	snz     HIJACK_RX_PARITY_COUNT[2].1
				;187			RET
0112	0003	ret
				;188			SNZ		F_CompleteRx1Bit
0113	39DF	snz     HIJACK_RX_PARITY_COUNT[1].3
				;189			RET
0114	0003	ret
				;190			CLR		F_CompleteRx1Bit
0115	35DF	clr     HIJACK_RX_PARITY_COUNT[1].3
				;191			
				;192			SZ		F_Parity_Ok
0116	3D60	sz      HIJACK_RX_PARITY_COUNT[2].2
				;193			JMP		Stop_Deal					
0117	2923	jmp     Stop_Deal
				;194			SNZ		hijack_Rx_Parity_Count.0
0118	385E	snz     HIJACK_RX_PARITY_COUNT.0
				;195			JMP		Paritylow
0119	291F	jmp     ParityLow
				;196			JMP		ParityHigh
011A	291B	jmp     ParityHigh
				;197	ParityHigh:	
				;198			SNZ		F_0or1Bit
				ParityHigh:
011B	3A5F	snz     HIJACK_RX_PARITY_COUNT[1].4
				;199			JMP		_hijack_Parity_StopMode_Error
011C	292B	jmp     _hijack_Parity_StopMode_Error
				;200			SET		F_Parity_Ok
011D	3160	set     HIJACK_RX_PARITY_COUNT[2].2
				;201			JMP		_hijack_Parity_StopMode_RET					
011E	292D	jmp     _hijack_Parity_StopMode_RET
				;202	ParityLow:		
				;203			SZ		F_0or1Bit
				ParityLow:
011F	3E5F	sz      HIJACK_RX_PARITY_COUNT[1].4
				;204			JMP		_hijack_Parity_StopMode_Error
0120	292B	jmp     _hijack_Parity_StopMode_Error
				;205			SET		F_Parity_Ok
0121	3160	set     HIJACK_RX_PARITY_COUNT[2].2
				;206			JMP		_hijack_Parity_StopMode_RET			
0122	292D	jmp     _hijack_Parity_StopMode_RET
				;207	Stop_Deal:
				;208			CLR		F_Parity_Ok
				Stop_Deal:
0123	3560	clr     HIJACK_RX_PARITY_COUNT[2].2
				;209			SNZ		F_0or1Bit
0124	3A5F	snz     HIJACK_RX_PARITY_COUNT[1].4
				;210			JMP		_hijack_Parity_StopMode_Error
0125	292B	jmp     _hijack_Parity_StopMode_Error
				;211			SET		F_Stop_idleMode
0126	31E0	set     HIJACK_RX_PARITY_COUNT[2].3
				;212			MOV		A,3
0127	0F03	mov     a, 3H
				;213			MOV		hijack_Idle_Count,A
0128	00DC	mov     HIJACK_IDLE_COUNT, a
				;214			CLR		F_Parity_StopMode				
0129	34E0	clr     HIJACK_RX_PARITY_COUNT[2].1
				;215			JMP		_hijack_Parity_StopMode_RET
012A	292D	jmp     _hijack_Parity_StopMode_RET
				;216	_hijack_Parity_StopMode_Error:
				;217			SET		F_hijack_Rx_Error
				_hijack_Parity_StopMode_Error:
012B	30DF	set     HIJACK_RX_PARITY_COUNT[1].1
				;218			RET	
012C	0003	ret
				;219	_hijack_Parity_StopMode_RET:			
				;220			RET
				_hijack_Parity_StopMode_RET:
012D	0003	ret
				;221	_hijack_Parity_StopMode ENDP
				;222	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;223	_hijack_PrepareMode PROC
				;224			SNZ		F_PrepareMode
				_hijack_PrepareMode:
012E	3ADF	snz     HIJACK_RX_PARITY_COUNT[1].5
				;225			RET
012F	0003	ret
				;226			SNZ		F_CompleteRx1Bit
0130	39DF	snz     HIJACK_RX_PARITY_COUNT[1].3
				;227			RET
0131	0003	ret
				;228	;		INC		TEST_COUNT2
				;229			CLR		F_CompleteRx1Bit
0132	35DF	clr     HIJACK_RX_PARITY_COUNT[1].3
				;230	;Idle		
				;231			SNZ		F_0or1Bit
0133	3A5F	snz     HIJACK_RX_PARITY_COUNT[1].4
				;232			RET
0134	0003	ret
				;233			CLR		F_PrepareMode
0135	36DF	clr     HIJACK_RX_PARITY_COUNT[1].5
				;234			SET		F_IdleMode
0136	335F	set     HIJACK_RX_PARITY_COUNT[1].6
				;235			RET
0137	0003	ret
				;236	_hijack_PrepareMode ENDP
				;237	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;238	_hijack_StartIdleMode PROC
				;239			SNZ		F_IdleMode
				_hijack_StartIdleMode:
0138	3B5F	snz     HIJACK_RX_PARITY_COUNT[1].6
				;240			RET
0139	0003	ret
				;241	;Idle		
				;242			SNZ		F_CompleteRx1Bit
013A	39DF	snz     HIJACK_RX_PARITY_COUNT[1].3
				;243			RET
013B	0003	ret
				;244			CLR		F_CompleteRx1Bit
013C	35DF	clr     HIJACK_RX_PARITY_COUNT[1].3
				;245			SDZ		hijack_Idle_Count
013D	17DC	sdz     HIJACK_IDLE_COUNT
				;246			JMP		$1
013E	2946	jmp     L0146
				;247	$0:		
				;248			SZ		F_0or1Bit
013F	3E5F	sz      HIJACK_RX_PARITY_COUNT[1].4
				;249			JMP		$2
0140	2944	jmp     L0144
				;250			CLR		F_IdleMode
0141	375F	clr     HIJACK_RX_PARITY_COUNT[1].6
				;251			SET		F_ByteMode
0142	33DF	set     HIJACK_RX_PARITY_COUNT[1].7
				;252			RET
0143	0003	ret
				;253	$2:		
				;254			SET		F_hijack_Rx_Error	;第四bit 還是1，錯誤
				L0144:
0144	30DF	set     HIJACK_RX_PARITY_COUNT[1].1
				;255			RET
0145	0003	ret
				;256	$1:		
				;257			SZ		F_0or1Bit		
				L0146:
0146	3E5F	sz      HIJACK_RX_PARITY_COUNT[1].4
				;258			RET						
0147	0003	ret
				;259			SET		F_hijack_Rx_Error	;3bit 1 Idle 不夠
0148	30DF	set     HIJACK_RX_PARITY_COUNT[1].1
				;260			RET				
0149	0003	ret
				;261	_hijack_StartIdleMode ENDP
				;262	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;263	_hijack_ENDIdleMode PROC
				;264			SNZ		F_Stop_idleMode
				_hijack_ENDIdleMode:
014A	39E0	snz     HIJACK_RX_PARITY_COUNT[2].3
				;265			RET
014B	0003	ret
				;266			SNZ		F_CompleteRx1Bit
014C	39DF	snz     HIJACK_RX_PARITY_COUNT[1].3
				;267			RET
014D	0003	ret
				;268			CLR		F_CompleteRx1Bit
014E	35DF	clr     HIJACK_RX_PARITY_COUNT[1].3
				;269			INC		TEST_COUNT
014F	14D9	inc     TEST_COUNT
				;270			SDZ		hijack_Idle_Count
0150	17DC	sdz     HIJACK_IDLE_COUNT
				;271			JMP		$1
0151	2958	jmp     L0158
				;272	$0:		
				;273			SZ		F_0or1Bit
0152	3E5F	sz      HIJACK_RX_PARITY_COUNT[1].4
				;274			
				;275			CLR		F_IdleMode
0153	375F	clr     HIJACK_RX_PARITY_COUNT[1].6
				;276			SET		F_ByteMode
0154	33DF	set     HIJACK_RX_PARITY_COUNT[1].7
				;277			RET
0155	0003	ret
				;278	$2:		
				;279			SET		F_hijack_Rx_Error	;第四bit 還是1，錯誤
0156	30DF	set     HIJACK_RX_PARITY_COUNT[1].1
				;280			RET
0157	0003	ret
				;281	$1:		
				;282	
				;283			SZ		F_0or1Bit		
				L0158:
0158	3E5F	sz      HIJACK_RX_PARITY_COUNT[1].4
				;284			RET						
0159	0003	ret
				;285			SET		F_hijack_Rx_Error	;3bit 1 Idle 不夠
015A	30DF	set     HIJACK_RX_PARITY_COUNT[1].1
				;286			RET					
015B	0003	ret
				;287	_hijack_ENDIdleMode ENDP
				;288	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;289	_hijack_Rx_Byte PROC
				;290			SNZ		F_ByteMode
				_hijack_Rx_Byte:
015C	3BDF	snz     HIJACK_RX_PARITY_COUNT[1].7
				;291			RET
015D	0003	ret
				;292			SNZ		F_CompleteRx1Bit
015E	39DF	snz     HIJACK_RX_PARITY_COUNT[1].3
				;293			RET
015F	0003	ret
				;294			CLR		F_CompleteRx1Bit		
0160	35DF	clr     HIJACK_RX_PARITY_COUNT[1].3
				;295			SNZ		F_hijackstartOk
0161	3860	snz     HIJACK_RX_PARITY_COUNT[2].0
				;296			JMP		$0
0162	2964	jmp     L0164
				;297			JMP		hijack_Rx_ByteEnter
0163	296F	jmp     hijack_Rx_ByteEnter
				;298	$0:
				;299			SNZ		F_0or1Bit
				L0164:
0164	3A5F	snz     HIJACK_RX_PARITY_COUNT[1].4
				;300			JMP		$1
0165	2968	jmp     L0168
				;301			SET		F_hijack_Rx_Error
0166	30DF	set     HIJACK_RX_PARITY_COUNT[1].1
				;302			RET
0167	0003	ret
				;303	$1:
				;304			SET		F_hijackstartOk
				L0168:
0168	3060	set     HIJACK_RX_PARITY_COUNT[2].0
				;305			MOV		A,16
0169	0F10	mov     a, 10H
				;306			MOV		hijack_Rx_Count,A
016A	00DD	mov     HIJACK_RX_COUNT, a
				;307			CLR		hijack_Receive_DataH
016B	1F4A	clr     HIJACK_RECEIVE_DATAH
				;308			CLR		hijack_Receive_DataL
016C	1F4B	clr     HIJACK_RECEIVE_DATAL
				;309			CLR		hijack_Rx_Parity_Count
016D	1F5E	clr     HIJACK_RX_PARITY_COUNT
				;310			RET										
016E	0003	ret
				;311	hijack_Rx_ByteEnter:
				;312			SDZ 	hijack_Rx_Count 	;16bit值是否已經讀取完成	
				hijack_Rx_ByteEnter:
016F	17DD	sdz     HIJACK_RX_COUNT
				;313			JMP		hijack_Rx_Byte_LOOP
0170	2975	jmp     hijack_Rx_Byte_LOOP
				;314			SET		F_CompleteRx1Bit
0171	31DF	set     HIJACK_RX_PARITY_COUNT[1].3
				;315			SET		F_Parity_StopMode	;進入下一個模式
0172	30E0	set     HIJACK_RX_PARITY_COUNT[2].1
				;316			CLR		F_ByteMode			
0173	37DF	clr     HIJACK_RX_PARITY_COUNT[1].7
				;317			RET
0174	0003	ret
				;318	hijack_Rx_Byte_LOOP:
				;319			CLR		C
				hijack_Rx_Byte_LOOP:
0175	340A	clr     C
				;320			RLC		hijack_Receive_DataL
0176	1ACB	rlc     HIJACK_RECEIVE_DATAL
				;321			RLC		hijack_Receive_DataH		
0177	1ACA	rlc     HIJACK_RECEIVE_DATAH
				;322			
				;323			SNZ		F_0or1Bit
0178	3A5F	snz     HIJACK_RX_PARITY_COUNT[1].4
				;324			JMP		hijack_Low
0179	297E	jmp     hijack_Low
				;325			JMP		hijack_High
017A	297B	jmp     hijack_High
				;326	hijack_High:
				;327			INC		hijack_Rx_Parity_Count
				hijack_High:
017B	14DE	inc     HIJACK_RX_PARITY_COUNT
				;328			SET		hijack_Receive_DataL.0
017C	304B	set     HIJACK_RECEIVE_DATAL.0
				;329			JMP		hijack_Next_Bit
017D	297F	jmp     hijack_Next_Bit
				;330	hijack_Low:
				;331			CLR		hijack_Receive_DataL.0
				hijack_Low:
017E	344B	clr     HIJACK_RECEIVE_DATAL.0
				;332	hijack_Next_Bit:
				;333			RET
				hijack_Next_Bit:
017F	0003	ret
				;334	_hijack_Rx_Byte ENDP
				;335	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;336	_hijack_Rx_1Bit PROC
				;337			SNZ		STMP0F
				_hijack_Rx_1Bit:
0180	3A11	snz     STMP0F
				;338			JMP		CCRA_interrupt
0181	2989	jmp     CCRA_interrupt
				;339	CCRP_interrupt:					
				;340			CLR		STMP0F
				CCRP_interrupt:
0182	3611	clr     STMP0F
				;341			INC		hijack_CCRP_count
0183	14D1	inc     HIJACK_CCRP_COUNT
				;342			MOV		A,hijack_CCRP_count
0184	0751	mov     a, HIJACK_CCRP_COUNT
				;343			XOR		A,hijack_Time_Out		
0185	0C28	xor     a, 28H
				;344			SNZ		Z
0186	390A	snz     Z
				;345			RET
0187	0003	ret
				;346			JMP		_hijack_Rx_1Bit_Error ;超出時間，錯誤
0188	29EC	jmp     _hijack_Rx_1Bit_Error
				;347	CCRA_interrupt:
				;348			SNZ		STMA0F
				CCRA_interrupt:
0189	3A91	snz     STMA0F
				;349			JMP		_hijack_Rx_1Bit_Error ;不是CCRA 中斷也不是CCRP中斷，錯誤
018A	29EC	jmp     _hijack_Rx_1Bit_Error
				;350			CLR		STMA0F
018B	3691	clr     STMA0F
				;351	;		INC		TEST_COUNT
				;352			MOV		A,00001000B
018C	0F08	mov     a, 8H
				;353			XORM	A,PA
018D	0494	xorm    a, PA
				;354			SZ		F_First_CCRA
018E	3C5F	sz      HIJACK_RX_PARITY_COUNT[1].0
				;355			JMP		Second_CCRA
018F	29AC	jmp     Second_CCRA
				;356	First_CCRA:	;第一次CCRA中斷 上升沿									
				;357			SET		F_First_CCRA
				First_CCRA:
0190	305F	set     HIJACK_RX_PARITY_COUNT[1].0
				;358			MOV		A,STM0AH					;Save CCRA value
0191	072D	mov     a, STM0AH
				;359			MOV		high_CCRA1_H,A	
0192	00D3	mov     HIGH_CCRA1_H, a
				;360			MOV		A,STM0AL					
0193	072C	mov     a, STM0AL
				;361			MOV		high_CCRA1_L,A	
0194	00D4	mov     HIGH_CCRA1_L, a
				;362			MOV		A,hijack_CCRP_count
0195	0751	mov     a, HIJACK_CCRP_COUNT
				;363			MOV		hijack_Period_L,A			;保存CCRP 的計數值
0196	00D8	mov     HIJACK_PERIOD_L, a
				;364			CLR		hijack_CCRP_count
0197	1F51	clr     HIJACK_CCRP_COUNT
				;365	;		INC		TEST_COUNT
				;366	;計算週期
				;367	;N x 512-high_First_CCRA_Count + high_Second_CCRA_Count
				;368	if stmCCRP_T==512
				;369			MOV		A,9
0198	0F09	mov     a, 9H
				;370			MOV		hijack_temp_count1,A 		;根據CCRP 的值修改移位的值
0199	00CF	mov     HIJACK_TEMP_COUNT1, a
				;371	endif
				;372	if stmCCRP_T==256
				;373			MOV		A,8
				;374			MOV		hijack_temp_count1,A 		;根據CCRP 的值修改移位的值
				;375	endif
				;376	$0:
				;377			CLR		C 							;移位進行乘法運算
				L019A:
019A	340A	clr     C
				;378			RLC		hijack_Period_L
019B	1AD8	rlc     HIJACK_PERIOD_L
				;379			RLC		hijack_Period_H	
019C	1AD7	rlc     HIJACK_PERIOD_H
				;380			SDZ		hijack_temp_count1
019D	17CF	sdz     HIJACK_TEMP_COUNT1
				;381			JMP		$0		
019E	299A	jmp     L019A
				;382			CLR		C							
019F	340A	clr     C
				;383			MOV		A,high_CCRA1_L				;加上第二次取得的CCRA 的值
01A0	0754	mov     a, HIGH_CCRA1_L
				;384			ADDM	A,hijack_Period_L
01A1	03D8	addm    a, HIJACK_PERIOD_L
				;385			MOV		A,high_CCRA1_H
01A2	0753	mov     a, HIGH_CCRA1_H
				;386			ADCM	A,hijack_Period_H		
01A3	13D7	adcm    a, HIJACK_PERIOD_H
				;387			CLR		C 
01A4	340A	clr     C
				;388			MOV		A,hijack_Period_L			;減去第一次取得的 CCRA 的值
01A5	0758	mov     a, HIJACK_PERIOD_L
				;389			SUB		A,high_CCRA2_L
01A6	0256	sub     a, HIGH_CCRA2_L
				;390			MOV		hijack_Period_L,A
01A7	00D8	mov     HIJACK_PERIOD_L, a
				;391			MOV		A,hijack_Period_H
01A8	0757	mov     a, HIJACK_PERIOD_H
				;392			SBC		A,high_CCRA2_H
01A9	1255	sbc     a, HIGH_CCRA2_H
				;393			MOV		hijack_Period_H,A		
01AA	00D7	mov     HIJACK_PERIOD_H, a
				;394	
				;395			JMP		hijack_Period					
01AB	29C7	jmp     hijack_Period_0
				;396	Second_CCRA:;第二次CCRA中斷 上升沿
				;397			CLR		F_First_CCRA
				Second_CCRA:
01AC	345F	clr     HIJACK_RX_PARITY_COUNT[1].0
				;398			MOV		A,STM0AH					;Save CCRA value
01AD	072D	mov     a, STM0AH
				;399			MOV		high_CCRA2_H,A	;
01AE	00D5	mov     HIGH_CCRA2_H, a
				;400			MOV		A,STM0AL					;
01AF	072C	mov     a, STM0AL
				;401			MOV		high_CCRA2_L,A	;
01B0	00D6	mov     HIGH_CCRA2_L, a
				;402			MOV		A,hijack_CCRP_count
01B1	0751	mov     a, HIJACK_CCRP_COUNT
				;403			MOV		hijack_Period_L,A			;保存CCRP 的計數值
01B2	00D8	mov     HIJACK_PERIOD_L, a
				;404			CLR		hijack_CCRP_count
01B3	1F51	clr     HIJACK_CCRP_COUNT
				;405	;		INC		TEST_COUNT		
				;406	;計算週期
				;407	;N x 512-high_First_CCRA_Count + high_Second_CCRA_Count
				;408	if stmCCRP_T==512
				;409			MOV		A,9
01B4	0F09	mov     a, 9H
				;410			MOV		hijack_temp_count1,A 		;根據CCRP 的值修改移位的值
01B5	00CF	mov     HIJACK_TEMP_COUNT1, a
				;411	endif
				;412	if stmCCRP_T==256
				;413			MOV		A,8
				;414			MOV		hijack_temp_count1,A 		;根據CCRP 的值修改移位的值
				;415	endif
				;416	$0:
				;417			CLR		C 							;移位進行乘法運算
				L01B6:
01B6	340A	clr     C
				;418			RLC		hijack_Period_L
01B7	1AD8	rlc     HIJACK_PERIOD_L
				;419			RLC		hijack_Period_H	
01B8	1AD7	rlc     HIJACK_PERIOD_H
				;420			SDZ		hijack_temp_count1
01B9	17CF	sdz     HIJACK_TEMP_COUNT1
				;421			JMP		$0		
01BA	29B6	jmp     L01B6
				;422			CLR		C							
01BB	340A	clr     C
				;423			MOV		A,high_CCRA2_L				;加上第二次取得的CCRA 的值
01BC	0756	mov     a, HIGH_CCRA2_L
				;424			ADDM	A,hijack_Period_L
01BD	03D8	addm    a, HIJACK_PERIOD_L
				;425			MOV		A,high_CCRA2_H
01BE	0755	mov     a, HIGH_CCRA2_H
				;426			ADCM	A,hijack_Period_H		
01BF	13D7	adcm    a, HIJACK_PERIOD_H
				;427			CLR		C 
01C0	340A	clr     C
				;428			MOV		A,hijack_Period_L			;減去第一次取得的 CCRA 的值
01C1	0758	mov     a, HIJACK_PERIOD_L
				;429			SUB		A,high_CCRA1_L
01C2	0254	sub     a, HIGH_CCRA1_L
				;430			MOV		hijack_Period_L,A
01C3	00D8	mov     HIJACK_PERIOD_L, a
				;431			MOV		A,hijack_Period_H
01C4	0757	mov     a, HIJACK_PERIOD_H
				;432			SBC		A,high_CCRA1_H
01C5	1253	sbc     a, HIGH_CCRA1_H
				;433			MOV		hijack_Period_H,A		
01C6	00D7	mov     HIJACK_PERIOD_H, a
				;434	hijack_Period:		
				;435	;判斷是否是0
				;436	hijack_Period_0:
				;437	;		INC		TEST_COUNT				
				;438			MOV		A,hijack_Period_H
				hijack_Period_0:
				hijack_Period:
01C7	0757	mov     a, HIJACK_PERIOD_H
				;439			XOR		A,5					;hijack_Period0_Max 高八位
01C8	0C05	xor     a, 5H
				;440			SNZ		Z
01C9	390A	snz     Z
				;441			JMP		hijack_Period_1				;高Byte不相等，判斷是否為Bit 1
01CA	29D5	jmp     hijack_Period_1
				;442	;高位相等，判斷低八位是否在容差範圍內		
				;443	        MOV     A,hijack_Period_L
01CB	0758	mov     a, HIJACK_PERIOD_L
				;444	        SUB     A,94H +Tolerance 
01CC	0AD5	sub     a, D5H
				;445	        SZ      C		
01CD	3C0A	sz      C
				;446			JMP		_hijack_Rx_1Bit_Error		;週期太大錯誤
01CE	29EC	jmp     _hijack_Rx_1Bit_Error
				;447	        MOV     A,hijack_Period_L
01CF	0758	mov     a, HIJACK_PERIOD_L
				;448	        SUB     A,94H - Tolerance 
01D0	0A53	sub     a, 53H
				;449	        SNZ      C			
01D1	380A	snz     C
				;450			JMP		_hijack_Rx_1Bit_Error		;週期太小錯誤
01D2	29EC	jmp     _hijack_Rx_1Bit_Error
				;451			CLR		F_0or1Bit					;由週期判斷為Bit 0
01D3	365F	clr     HIJACK_RX_PARITY_COUNT[1].4
				;452			JMP		_hijack_Rx_1Bit_RET
01D4	29EA	jmp     _hijack_Rx_1Bit_RET
				;453	hijack_Period_1:	;是否在294H~316H之間		
				;454			MOV		A,hijack_Period_H
				hijack_Period_1:
01D5	0757	mov     a, HIJACK_PERIOD_H
				;455			XOR		A,2					;hijack_Period1_Max 高八位
01D6	0C02	xor     a, 2H
				;456			SZ		Z
01D7	3D0A	sz      Z
				;457			JMP		highByte2				;==2，判斷是否在294~300之間
01D8	29E3	jmp     highByte2
				;458	;是否==3
				;459			MOV		A,hijack_Period_H
01D9	0757	mov     a, HIJACK_PERIOD_H
				;460			XOR		A,3					;hijack_Period1_Max 高八位
01DA	0C03	xor     a, 3H
				;461			SZ		Z
01DB	3D0A	sz      Z
				;462			JMP		highByte3	
01DC	29DE	jmp     highByte3
				;463			JMP		_hijack_Rx_1Bit_Error	;高Byte既不是2也不是3，錯誤
01DD	29EC	jmp     _hijack_Rx_1Bit_Error
				;464	highByte3: ;300~316H
				;465	        MOV     A,hijack_Period_L
				highByte3:
01DE	0758	mov     a, HIJACK_PERIOD_L
				;466	        SUB     A,016H
01DF	0A16	sub     a, 16H
				;467	        SZ      C
01E0	3C0A	sz      C
				;468	        JMP		_hijack_Rx_1Bit_Error
01E1	29EC	jmp     _hijack_Rx_1Bit_Error
				;469	        JMP		thisis1		
01E2	29E8	jmp     thisis1
				;470	highByte2:		
				;471	;294H~300H之間
				;472	        MOV     A,hijack_Period_L
				highByte2:
01E3	0758	mov     a, HIJACK_PERIOD_L
				;473	        SUB     A,094H
01E4	0A94	sub     a, 94H
				;474	        SNZ      C
01E5	380A	snz     C
				;475	        JMP		_hijack_Rx_1Bit_Error
01E6	29EC	jmp     _hijack_Rx_1Bit_Error
				;476	        JMP		thisis1
01E7	29E8	jmp     thisis1
				;477	thisis1:
				;478			SET		F_0or1Bit
				thisis1:
01E8	325F	set     HIJACK_RX_PARITY_COUNT[1].4
				;479			JMP		_hijack_Rx_1Bit_RET				
01E9	29EA	jmp     _hijack_Rx_1Bit_RET
				;480	
				;481	_hijack_Rx_1Bit_RET:
				;482			SET		F_CompleteRx1Bit		
				_hijack_Rx_1Bit_RET:
01EA	31DF	set     HIJACK_RX_PARITY_COUNT[1].3
				;483			RET
01EB	0003	ret
				;484	_hijack_Rx_1Bit_Error:
				;485			SET		F_hijack_Rx_Error		;CCRP 連續發生的次數超過設定值(週期時間太長 Error)
				_hijack_Rx_1Bit_Error:
01EC	30DF	set     HIJACK_RX_PARITY_COUNT[1].1
				;486			RET								;置錯誤標誌位
01ED	0003	ret
				;487	_hijack_Rx_1Bit ENDP
				;488	
				;489	
				;490	
				;491		
				;492	
				;493	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;494	_hijack_init PROC
				;495	if stmCCRP_T==512
				;496			MOV		A,00000100B	;4/fsys  512 CCRP interrput
				_hijack_init:
01EE	0F04	mov     a, 4H
				;497			MOV		STM0C0,A
01EF	00A8	mov     STM0C0, a
				;498	endif
				;499	if stmCCRP_T==256
				;500			MOV		A,00000010B	;4/fsys  512 CCRP interrput
				;501			MOV		STM0C0,A
				;502	endif	
				;503			MOV		A,01000000B	;輸入捕捉模式、上升沿觸發、P 清除time
01F0	0F40	mov     a, 40H
				;504			MOV		STM0C1,A
01F1	00A9	mov     STM0C1, a
				;505			
				;506			SET		hijack_channel_L_IO
01F2	3315	set     PAC6
				;507			CLR		hijack_channel_L
01F3	3714	clr     PA6
				;508			
				;509			CLR		STP0IPS		;STP0I on PA6
01F4	3618	clr     STP0IPS
				;510			
				;511			SET		STMA0E		;開啟Timer 輸入捕捉模式中斷
01F5	3091	set     STMA0E
				;512			SET		STMP0E
01F6	3011	set     STMP0E
				;513			SET		MF0E
01F7	300F	set     MF0E
				;514			CLR		MF0F
01F8	360F	clr     MF0F
				;515			CLR		STMA0F
01F9	3691	clr     STMA0F
				;516			CLR		STMP0F
01FA	3611	clr     STMP0F
				;517			SET		ST0ON
01FB	31A8	set     ST0ON
				;518			SET		EMI
01FC	300E	set     EMI
				;519			RET
01FD	0003	ret
				;520	_hijack_init ENDP
				;521	
				;522	
				;523	
				;524	
				;525	;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;526	_hijack_Send_Byte PROC
				;527	;		local temp  D
				;528	 		CLR		hijack_channel_MIC
				_hijack_Send_Byte:
01FE	3514	clr     PA2
				;529	 		MOV		A,8 ;SET 8 BIT COUNTER
01FF	0F08	mov     a, 8H
				;530	 		MOV		hijack_temp_count1,A
0200	00CF	mov     HIJACK_TEMP_COUNT1, a
				;531	hijack_send_8bitloop:
				;532			SZ		hijack_temp_Byte.7
				hijack_send_8bitloop:
0201	3FCE	sz      HIJACK_TEMP_BYTE.7
				;533			JMP		hijack_send_high
0202	2A04	jmp     hijack_send_high
				;534			JMP		hijack_send_low
0203	2A10	jmp     hijack_send_low
				;535	hijack_send_high:
				;536			INC		hijack_temp_count2		;奇校驗
				hijack_send_high:
0204	14D0	inc     HIJACK_TEMP_COUNT2
				;537			SET		hijack_channel_MIC
0205	3114	set     PA2
				;538			DELAY	fskDelaycount1/3		;Delay延遲了3倍，so fskDelaycount0/3為正確值
0206	0F3C	mov     a, 3CH
0207	0001	clr     wdt
				L0208:
0208	1785	sdz     ACC
0209	2A08	jmp     L0208
				;539			CLR		hijack_channel_MIC
020A	3514	clr     PA2
				;540			DELAY	fskDelaycount1/3		;Delay延遲了3倍，so fskDelaycount0/3為正確值
020B	0F3C	mov     a, 3CH
020C	0001	clr     wdt
				L020D:
020D	1785	sdz     ACC
020E	2A0D	jmp     L020D
				;541			JMP		hijack_send_Next_Bit	
020F	2A1A	jmp     hijack_send_Next_Bit
				;542	hijack_send_low:		
				;543			SET		hijack_channel_MIC	;
				hijack_send_low:
0210	3114	set     PA2
				;544			DELAY	fskDelaycount0/3		;Delay延遲了3倍，so fskDelaycount0/3為正確值
0211	0F78	mov     a, 78H
0212	0001	clr     wdt
				L0213:
0213	1785	sdz     ACC
0214	2A13	jmp     L0213
				;545			CLR		hijack_channel_MIC
0215	3514	clr     PA2
				;546			DELAY	fskDelaycount0/3		;Delay延遲了3倍，so fskDelaycount0/3為正確值 		
0216	0F78	mov     a, 78H
0217	0001	clr     wdt
				L0218:
0218	1785	sdz     ACC
0219	2A18	jmp     L0218
				;547	hijack_send_Next_Bit:
				;548			RL		hijack_temp_Byte
				hijack_send_Next_Bit:
021A	18CE	rl      HIJACK_TEMP_BYTE
				;549			SDZ		hijack_temp_count1
021B	17CF	sdz     HIJACK_TEMP_COUNT1
				;550			JMP		hijack_send_8bitloop
021C	2A01	jmp     hijack_send_8bitloop
				;551	
				;552	_hijack_Send_Byte_RET:
				;553			RET 
				_hijack_Send_Byte_RET:
021D	0003	ret
				;554	_hijack_Send_Byte ENDP
				;555	;;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@	
				;556	hijack_send_odd_Bit PROC
				;557			SZ		hijack_temp_count2.0
				hijack_send_odd_Bit:
021E	3C50	sz      HIJACK_TEMP_COUNT2.0
				;558			JMP		hijack_send_odd_Bit_Low
021F	2A2B	jmp     hijack_send_odd_Bit_Low
				;559	;		JMP		hijack_odd_Bit_high	
				;560	hijack_send_odd_Bit_high:
				;561			SET		hijack_channel_MIC
				hijack_send_odd_Bit_high:
0220	3114	set     PA2
				;562			DELAY	fskDelaycount1/3		;Delay延遲了3倍，so fskDelaycount0/3為正確值
0221	0F3C	mov     a, 3CH
0222	0001	clr     wdt
				L0223:
0223	1785	sdz     ACC
0224	2A23	jmp     L0223
				;563			CLR		hijack_channel_MIC
0225	3514	clr     PA2
				;564			DELAY	fskDelaycount1/3		;Delay延遲了3倍，so fskDelaycount0/3為正確值
0226	0F3C	mov     a, 3CH
0227	0001	clr     wdt
				L0228:
0228	1785	sdz     ACC
0229	2A28	jmp     L0228
				;565			JMP		hijack_send_odd_Bit_RET		
022A	2A35	jmp     hijack_send_odd_Bit_RET
				;566	hijack_send_odd_Bit_Low:
				;567			SET		hijack_channel_MIC	;
				hijack_send_odd_Bit_Low:
022B	3114	set     PA2
				;568			DELAY	fskDelaycount0/3		;Delay延遲了3倍，so fskDelaycount0/3為正確值
022C	0F78	mov     a, 78H
022D	0001	clr     wdt
				L022E:
022E	1785	sdz     ACC
022F	2A2E	jmp     L022E
				;569			CLR		hijack_channel_MIC
0230	3514	clr     PA2
				;570			DELAY	fskDelaycount0/3		;Delay延遲了3倍，so fskDelaycount0/3為正確值
0231	0F78	mov     a, 78H
0232	0001	clr     wdt
				L0233:
0233	1785	sdz     ACC
0234	2A33	jmp     L0233
				;571	hijack_send_odd_Bit_RET:
				;572			RET 							
				hijack_send_odd_Bit_RET:
0235	0003	ret
				;573	hijack_send_odd_Bit ENDP
				;574	;;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;575	_hijack_Send_Bias PROC
				;576	;用於先建立bias
				;577	 		MOV		A,12 ;SET 8 BIT COUNTER
				_hijack_Send_Bias:
0236	0F0C	mov     a, CH
				;578	 		MOV		hijack_temp_count1,A
0237	00CF	mov     HIJACK_TEMP_COUNT1, a
				;579	$1:		
				;580			SET		hijack_channel_MIC	;
				L0238:
0238	3114	set     PA2
				;581			DELAY	fskDelaycount0/3		;Delay延遲了3倍，so fskDelaycount0/3為正確值
0239	0F78	mov     a, 78H
023A	0001	clr     wdt
				L023B:
023B	1785	sdz     ACC
023C	2A3B	jmp     L023B
				;582			CLR		hijack_channel_MIC
023D	3514	clr     PA2
				;583			DELAY	fskDelaycount0/3		;Delay延遲了3倍，so fskDelaycount0/3為正確值 		
023E	0F78	mov     a, 78H
023F	0001	clr     wdt
				L0240:
0240	1785	sdz     ACC
0241	2A40	jmp     L0240
				;584			SDZ		hijack_temp_count1
0242	17CF	sdz     HIJACK_TEMP_COUNT1
				;585			JMP		$1					
0243	2A38	jmp     L0238
				;586			RET
0244	0003	ret
				;587	_hijack_Send_Bias ENDP
				;588	;;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;589	_hijack_Send_Idle PROC
				;590	;,3bit 1頻率的idle信號，用於信號發送的開始和結束
				;591	 		MOV		A,3 					;SET 8 BIT COUNTER
				_hijack_Send_Idle:
0245	0F03	mov     a, 3H
				;592	 		MOV		hijack_temp_count1,A
0246	00CF	mov     HIJACK_TEMP_COUNT1, a
				;593	$1: 		
				;594			SET		hijack_channel_MIC	;
				L0247:
0247	3114	set     PA2
				;595			DELAY	fskDelaycount1/3		;Delay延遲了3倍，so fskDelaycount0/3為正確值
0248	0F3C	mov     a, 3CH
0249	0001	clr     wdt
				L024A:
024A	1785	sdz     ACC
024B	2A4A	jmp     L024A
				;596			CLR		hijack_channel_MIC
024C	3514	clr     PA2
				;597			DELAY	fskDelaycount1/3		;Delay延遲了3倍，so fskDelaycount0/3為正確值
024D	0F3C	mov     a, 3CH
024E	0001	clr     wdt
				L024F:
024F	1785	sdz     ACC
0250	2A4F	jmp     L024F
				;598			SDZ		hijack_temp_count1
0251	17CF	sdz     HIJACK_TEMP_COUNT1
				;599			JMP		$1
0252	2A47	jmp     L0247
				;600			RET	
0253	0003	ret
				;601	_hijack_Send_Idle ENDP
				;602	;;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;603	_hijack_Send_Start PROC
				;604	;1bit 0頻率 用於開始信號,		
				;605			SET		hijack_channel_MIC	;
				_hijack_Send_Start:
0254	3114	set     PA2
				;606			DELAY	fskDelaycount0/3		;Delay延遲了3倍，so fskDelaycount0/3為正確值
0255	0F78	mov     a, 78H
0256	0001	clr     wdt
				L0257:
0257	1785	sdz     ACC
0258	2A57	jmp     L0257
				;607			CLR		hijack_channel_MIC
0259	3514	clr     PA2
				;608			DELAY	fskDelaycount0/3		;Delay延遲了3倍，so fskDelaycount0/3為正確值
025A	0F78	mov     a, 78H
025B	0001	clr     wdt
				L025C:
025C	1785	sdz     ACC
025D	2A5C	jmp     L025C
				;609			RET	
025E	0003	ret
				;610	_hijack_Send_Start ENDP
				;611	;;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
				;612	_hijack_Send_Stop PROC
				;613	;1bit 1頻率用於結束信號,		
				;614			SET		hijack_channel_MIC	;
				_hijack_Send_Stop:
025F	3114	set     PA2
				;615			DELAY	fskDelaycount1/3		;Delay延遲了3倍，so fskDelaycount0/3為正確值
0260	0F3C	mov     a, 3CH
0261	0001	clr     wdt
				L0262:
0262	1785	sdz     ACC
0263	2A62	jmp     L0262
				;616			CLR		hijack_channel_MIC
0264	3514	clr     PA2
				;617			DELAY	fskDelaycount1/3		;Delay延遲了3倍，so fskDelaycount0/3為正確值
0265	0F3C	mov     a, 3CH
0266	0001	clr     wdt
				L0267:
0267	1785	sdz     ACC
0268	2A67	jmp     L0267
				;618			RET	
0269	0003	ret
				;619	_hijack_Send_Stop ENDP
				data .SECTION 'DATA'
				R_ATEMP DB DUP (?)
				R_STATUS DB DUP (?)
				IIC_DEVICE_ADDR DB DUP (?)
				IIC_RECEIVE_DATA DB DUP (?)
				IIC_SEND_DATA DB DUP (?)
				IIC_TEMP_CONUNT1 DB DUP (?)
				IIC_TEMP_CONUNT2 DB DUP (?)
				IIC_TEMP_BYTE DB DUP (?)
				HIJACK_RECEIVE_DATAH DB DUP (?)
				HIJACK_RECEIVE_DATAL DB DUP (?)
				HIJACK_SEND_DATA_HIGH DB DUP (?)
				HIJACK_SEND_DATA_LOW DB DUP (?)
				HIJACK_TEMP_BYTE DB DUP (?)
				HIJACK_TEMP_COUNT1 DB DUP (?)
				HIJACK_TEMP_COUNT2 DB DUP (?)
				HIJACK_CCRP_COUNT DB DUP (?)
				HIJACK_RX_STEP DB DUP (?)
				HIGH_CCRA1_H DB DUP (?)
				HIGH_CCRA1_L DB DUP (?)
				HIGH_CCRA2_H DB DUP (?)
				HIGH_CCRA2_L DB DUP (?)
				HIJACK_PERIOD_H DB DUP (?)
				HIJACK_PERIOD_L DB DUP (?)
				TEST_COUNT DB DUP (?)
				TEST_COUNT2 DB DUP (?)
				TEST_COUNT3 DB DUP (?)
				HIJACK_IDLE_COUNT DB DUP (?)
				HIJACK_RX_COUNT DB DUP (?)
				HIJACK_RX_PARITY_COUNT DB DUP (?)
				F_EMI DB DUP (?) ; F_EMI
				IIC_TEMP_FLAG DB DUP (?) ; IIC_TEMP_FLAG
				F_FIRST_CCRA DB DUP (?) ; F_FIRST_CCRA
				F_HIJACK_RX_ERROR DB DUP (?) ; F_HIJACK_RX_ERROR
				F_HIJACK_RX_START DB DUP (?) ; F_HIJACK_RX_START
				F_COMPLETERX1BIT DB DUP (?) ; F_COMPLETERX1BIT
				F_0OR1BIT DB DUP (?) ; F_0OR1BIT
				F_PREPAREMODE DB DUP (?) ; F_PREPAREMODE
				F_IDLEMODE DB DUP (?) ; F_IDLEMODE
				F_BYTEMODE DB DUP (?) ; F_BYTEMODE
				F_HIJACKSTARTOK DB DUP (?) ; F_HIJACKSTARTOK
				F_PARITY_STOPMODE DB DUP (?) ; F_PARITY_STOPMODE
				F_PARITY_OK DB DUP (?) ; F_PARITY_OK
				F_STOP_IDLEMODE DB DUP (?) ; F_STOP_IDLEMODE
				F_FIRST_PARITY_STOPMODE DB DUP (?) ; F_FIRST_PARITY_STOPMODE
